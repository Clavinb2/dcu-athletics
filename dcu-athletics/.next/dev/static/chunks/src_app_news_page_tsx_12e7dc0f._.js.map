{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/barry/Documents/Final-Year/DCU-athletics-site/dcu-athletics/src/app/news/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport Link from \"next/link\";\nimport Head from \"next/head\";\nimport Image from \"next/image\";\n\ntype Post = {\n  id: number;\n  title: string;\n  content: string;\n  author: string;\n  created_at: string;\n  image?: string | null;\n  tags?: string[];\n};\n\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE || \"http://localhost:8000\";\n\nexport default function NewsPage() {\n  const [posts, setPosts] = useState<Post[]>([]);\n  const [count, setCount] = useState(0);\n  const [page, setPage] = useState(1);\n  const [search, setSearch] = useState(\"\");\n  const [selectedTags, setSelectedTags] = useState<string[]>([]);\n\n  async function fetchPosts() {\n    const params = new URLSearchParams();\n    params.set(\"page\", String(page));\n    if (search.trim()) params.set(\"search\", search.trim());\n    if (selectedTags.length) params.set(\"tags\", selectedTags.join(\",\"));\n    const res = await fetch(`${API_BASE}/api/posts/?${params.toString()}`, { cache: \"no-store\" });\n    const data = await res.json();\n    if (Array.isArray(data)) {\n      setPosts(data);\n      setCount(data.length);\n    } else {\n      setPosts(data.results || []);\n      setCount(data.count || 0);\n    }\n  }\n\n  useEffect(() => {\n    fetchPosts();\n  }, [page]);\n\n  useEffect(() => {\n    const t = setTimeout(() => {\n      setPage(1);\n      fetchPosts();\n    }, 300);\n    return () => clearTimeout(t);\n  }, [search, selectedTags]);\n\n  const availableTags = useMemo(() => {\n    const s = new Set<string>();\n    posts.forEach(p => (p.tags || []).forEach(t => s.add(t)));\n    return Array.from(s).sort();\n  }, [posts]);\n\n  const siteBase = \"https://athletics.dcu.ie\";\n\n  return (\n    <>\n    <Head>\n      <title>Latest News & Announcements | DCU Athletics</title>\n      <meta name=\"description\" content=\"DCU Athletics news, results, reports and announcements.\" />\n      <script type=\"application/ld+json\">{JSON.stringify({\n        \"@context\": \"https://schema.org\",\n        \"@type\": \"BreadcrumbList\",\n        \"itemListElement\": [{ \"@type\": \"ListItem\", \"position\": 1, \"name\": \"Home\", \"item\": `${siteBase}/` }, { \"@type\": \"ListItem\", \"position\": 2, \"name\": \"News\", \"item\": `${siteBase}/news` }],\n      })}</script>\n      <script type=\"application/ld+json\">{JSON.stringify({\n        \"@context\": \"https://schema.org\",\n        \"@type\": \"Blog\",\n        \"name\": \"DCU Athletics News\",\n        \"url\": `${siteBase}/news`,\n        \"blogPost\": posts.map((post, i) => ({\n          \"@type\": \"BlogPosting\",\n          \"headline\": post.title,\n          \"url\": `${siteBase}/news/${post.id}`,\n          \"position\": i + 1\n        }))\n      })}\n      </script>\n    </Head>\n    <div className=\"max-w-5xl mx-auto p-6\">\n      <h1 className=\"text-3xl font-bold mb-6 text-blue-700 dark:text-yellow-400\">Latest News</h1>\n\n      <div className=\"mb-6 flex flex-col sm:flex-row gap-3 sm:items-center\">\n        <input\n          value={search}\n          onChange={(e) => setSearch(e.target.value)}\n          placeholder=\"Search news...\"\n          className=\"border rounded-full px-4 py-2 w-full sm:w-80\"\n          aria-label=\"Search news\"\n        />\n        <div className=\"flex flex-wrap gap-2\">\n          {availableTags.map((t) => {\n            const active = selectedTags.includes(t);\n            return (\n              <button\n                key={t}\n                onClick={() => setSelectedTags((prev) => active ? prev.filter(x => x !== t) : [...prev, t])}\n                className={`px-3 py-1 rounded-full text-sm border ${active ? 'bg-blue-700 text-white border-blue-700' : 'border-gray-300'}`}\n                aria-pressed={active}\n              >\n                {t}\n              </button>\n            );\n          })}\n        </div>\n      </div>\n\n      <div className=\"space-y-6\">\n        {posts.map((post) => {\n          const imageUrl = post.image\n            ? post.image.startsWith('http')\n              ? post.image\n              : `${API_BASE}${post.image}`\n            : null;\n          return (\n            <article key={post.id} className=\"bg-white rounded-xl shadow p-5 dark:bg-gray-700\">\n              <h2 className=\"text-2xl font-semibold text-blue-700 dark:text-yellow-300\">\n                <Link href={`/news/${post.id}`}>{post.title}</Link>\n              </h2>\n              <p className=\"text-gray-600 text-sm mb-3 dark:text-gray-400\">By {post.author} Â· {new Date(post.created_at).toLocaleDateString()}</p>\n              {imageUrl && (\n                <Image src={imageUrl} alt={post.title} width={1200} height={630} className=\"rounded mb-4 w-full object-cover\" sizes=\"(max-width: 640px) 100vw, 50vw\" />\n              )}\n              <div className=\"flex flex-wrap gap-1 mb-2\">\n                {(post.tags || []).map((t) => (\n                  <span key={`${post.id}-${t}`} className=\"text-xs px-2 py-0.5 rounded-full bg-blue-50 text-blue-700 border border-blue-100\">{t}</span>\n                ))}\n              </div>\n              <p className=\"whitespace-pre-wrap line-clamp-4\">{post.content}</p>\n              <Link href={`/news/${post.id}`} className=\"mt-3 inline-block text-blue-700 hover:underline dark:text-yellow-400\">Read more</Link>\n            </article>\n          );\n        })}\n        {posts.length === 0 && <p className=\"text-gray-600 dark:text-gray-300\">No news found.</p>}\n      </div>\n\n      <div className=\"flex items-center justify-center gap-2 mt-8\">\n        <button disabled={page <= 1} onClick={() => setPage((p) => Math.max(1, p - 1))} className=\"px-4 py-2 rounded border disabled:opacity-50\">Prev</button>\n        <span className=\"text-sm text-gray-600 dark:text-gray-300\">Page {page}</span>\n        <button disabled={posts.length === 0 || (count !== 0 && page * 10 >= count)} onClick={() => setPage((p) => p + 1)} className=\"px-4 py-2 rounded border disabled:opacity-50\">Next</button>\n      </div>\n    </div>\n    </>\n  );\n}\n\n\n"],"names":[],"mappings":"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","debugId":null}}]
}